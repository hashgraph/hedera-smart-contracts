run.name=clpr-it1-odin-two-source
working.dir=.
network=local
execution.mode=sequential

agents=agent1,agent2

#
# Reliability knobs
#
# SOLO/relay can intermittently return transaction reverts that "should not happen" (and may succeed on retry).
# Keep these tunable so we can adjust without code changes.
#
agent.action.retries=4
agent.action.baseDelayMs=2000
run.failOnRetries=false

checks.rpcReceipt.maxWaitMs=20000
checks.rpcReceipt.pollIntervalMs=1000

checks.mirrorResult.maxWaitMs=60000
checks.mirrorResult.pollIntervalMs=2000

checks.sourceState.maxWaitMs=30000
checks.sourceState.pollIntervalMs=2000

checks.requireRpcReceipt=true
checks.requireMirrorResult=true
checks.requireSourceState=true

agent.action.commandTemplate=ODIN_SOURCE_APP=${sourceApp} ODIN_SOURCE_MIDDLEWARE=${sourceMiddleware} ODIN_DESTINATION_MIDDLEWARE=${destinationMiddleware} ODIN_ECHO_APP=${echoApp} ODIN_PAYLOAD=${payload} npx hardhat run scripts/odin/agent-send.js --network ${network} --no-compile
agent.sense.commandTemplate=ODIN_SOURCE_APP=${sourceApp} npx hardhat run scripts/odin/agent-read-source-state.js --network ${network} --no-compile

agent.agent1.sourceAppKey=sourceApp1.address
agent.agent1.payload=clpr-it1-odin-agent-1
agent.agent1.expectedPayload=clpr-it1-odin-agent-1
agent.agent1.expectedResponseCount=1

agent.agent2.sourceAppKey=sourceApp2.address
agent.agent2.payload=clpr-it1-odin-agent-2
agent.agent2.expectedPayload=clpr-it1-odin-agent-2
agent.agent2.expectedResponseCount=1
